[prova]
exten => 9101,1,Answer()
	same => n,PlayBack(Genius_digite_os_numeros)
	same => n,Goto(Contador,reset_contador)
	same => n(fale_a_sequencia),SayDigits(${sequencia})
	same => n(espere_tres_sec),WaitExten(3)

exten => 1,1,NoOp()
	same => n,GotoIf($[ ${sequencia:${contador}:1} = 1]?:Errou,1)
	same => n,GotoIf($[$[${contador}+1] = ${LEN(${sequencia})}]?Contador,reset_contador:Contador,contador_mais_um)
exten => 2,1,NoOp()
	same => n,GotoIf($[ ${sequencia:${contador}:1} = 2]?:Errou,1)
	same => n,GotoIf($[$[${contador}+1] = ${LEN(${sequencia})}]?Contador,reset_contador:Contador,contador_mais_um)
exten => 3,1,NoOp()
	same => n,GotoIf($[ ${sequencia:${contador}:1} = 3]?:Errou,1)
	same => n,GotoIf($[$[${contador}+1] = ${LEN(${sequencia})}]?Contador,reset_contador:Contador,contador_mais_um)
exten => 4,1,NoOp()
	same => n,GotoIf($[ ${sequencia:${contador}:1} = 4]?:Errou,1)
	same => n,GotoIf($[$[${contador}+1] = ${LEN(${sequencia})}]?Contador,reset_contador:Contador,contador_mais_um)

exten => t,1,NoOp()
	same => n,Goto(Errou,1)		
exten => i,1,NoOp()
	same => n,Goto(Errou,1)

exten => Contador,1,NoOp()
  	same => n(reset_contador),Set(contador=0)
	same => n,Goto(SortearNum,1)
	same => n(contador_mais_um),Set(contador=$[${contador}+1])	
	same => n,Goto(9101,espere_tres_sec)

exten => SortearNum,1,NoOp()
	same => n,Set(sequencia=${sequencia}${RAND(1,4)})
	same => n,WaitExten(1)
	same => n,Goto(9101,fale_a_sequencia)	

exten => Errou,1,NoOp()
	same => n,PlayBack(Genius_sequencia_incorreta)
	same => n,SayDigits(${sequencia})
	same => n,PLayBack(Genius_acertos)
	same => n,SayNumber($[${LEN(${sequencia})}-1])
	same => n,PlayBack(Genius_ate_logo)


[prova2]
exten => 9102,1,Answer()
	same => n,PlayBack(Genius_digite_os_numeros)
        same => n,Goto(Contador9102,reset_contador)
        same => n(fale_a_sequencia),SayDigits(${sequencia})
        same => n(espere_tres_sec),WaitExten(3)
exten => 1,1,NoOp()
        same => n,GotoIf($[ ${sequencia:${contador}:1} = 1]?:Errou9102,1)
        same => n,GotoIf($[$[${contador}+1] = ${LEN(${sequencia})}]?Contador9102,reset_contador:Contador9102,contador_mais_um)
exten => 2,1,NoOp()
        same => n,GotoIf($[ ${sequencia:${contador}:1} = 2]?:Errou9102,1)
        same => n,GotoIf($[$[${contador}+1] = ${LEN(${sequencia})}]?Contador9102,reset_contador:Contador9102,contador_mais_um)
exten => 3,1,NoOp()
        same => n,GotoIf($[ ${sequencia:${contador}:1} = 3]?:Errou9102,1)
        same => n,GotoIf($[$[${contador}+1] = ${LEN(${sequencia})}]?Contador9102,reset_contador:Contador9102,contador_mais_um)
exten => 4,1,NoOp()
        same => n,GotoIf($[ ${sequencia:${contador}:1} = 4]?:Errou9102,1)
        same => n,GotoIf($[$[${contador}+1] = ${LEN(${sequencia})}]?Contador9102,reset_contador:Contador9102,contador_mais_um)
exten => t,1,NoOp()
        same => n,Goto(Errou9102,1)
exten => i,1,NoOp()
        same => n,Goto(Errou9102,1)
exten => Contador9102,1,NoOp()
        same => n(reset_contador),Set(contador=0)
        same => n,Goto(SortearNum9102,1)
        same => n(contador_mais_um),Set(contador=$[${contador}+1])
        same => n,Goto(9102,espere_tres_sec)
exten => SortearNum9102,1,NoOp()
        same => n,Set(sequencia=${sequencia}${RAND(1,4)})
        same => n,PlayBack(silence/1)
        same => n,Goto(9102,fale_a_sequencia)
exten => Errou9102,1,NoOp()
	same => n,PlayBack(Genius_sequencia_incorreta)
        same => n,SayDigits(${sequencia})
        same => n,PLayBack(Genius_acertos)
        same => n,SayNumber($[${LEN(${sequencia})}-1])
	same => n,Goto(Banco_de_dados,1)

exten => Banco_de_dados,1,NoOp()
	same => n,PlayBack(Genius_media_de_acertos)
        same => n,Set(COUNT=${DB(ligacao/${CALLERID(num)})})
	same => n,Set(VAR=${DB(somatorio/${CALLERID(num)})})
	same => n,GotoIf($[${ISNULL(${COUNT})} & ${ISNULL(${VAR})} ]?:continue)
	same => n,Set(DB(ligacao/${CALLERID(num)})=1)
	same => n,Set(DB(somatorio/${CALLERID(num)})=$[${LEN(${sequencia})}-1])
	same => n,Goto(pegando_valor)
	same => n(continue),NoOp()
	same => n,Set(DB(ligacao/${CALLERID(num)})=$[${COUNT}+1])
	same => n,Set(DB(somatorio/${CALLERID(num)})=$[${VAR}+$[${LEN(${sequencia})}-1]])
	same => n(pegando_valor),NoOp()	
	same => n,Set(NOVOVALORLIGACAO=${DB(ligacao/${CALLERID(num)})})
	same => n,Set(NOVOVALORSOMATORIO=${DB(somatorio/${CALLERID(num)})})
	same => n,Set(VALOR=${MATH(${NOVOVALORSOMATORIO}/${NOVOVALORLIGACAO},int)})
	same => n,SayNumber(${VALOR})
	same => n,PlayBack(Genius_ate_logo)

exten => _##XXXX.,1,verbose(1,"Chamada exemplo da prova. Numero {$EXTEN:2}")
	same => n,Dial(SIP/server06/${EXTEN:2})
